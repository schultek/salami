<!DOCTYPE html>

<html>
    <head>
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
        <link rel="stylesheet" type="text/css" href="css/styles.css">
        <link rel="stylesheet" type="text/css" href="css/font-awesome.min.css" />
        <link rel="stylesheet" href="css/mfglabs_iconset.css">

        <!-- Insert this line above script imports  -->
        <script>if (typeof module === 'object') {window.module = module; module = undefined;}</script>

        <script src="lib/vue.min.js"></script>
        <script src="lib/jquery.min.js"></script>
        <script src="lib/snap.svg.js"></script>
        <script src="lib/lodash.core.js"></script>
        <script src="lib/socket.io.js"></script>
        <script src="lib/opentype.min.js"></script>

        <!-- Insert this line after script imports -->
        <script>if (window.module) module = window.module;</script>

        <title>WebCarve</title>
    </head>
    <body onkeydown="handleToolKey(event)" onkeyup="handleShortcuts(event)" style="-moz-user-select: none; -webkit-user-select: none; -ms-user-select:none; user-select:none;-o-user-select:none;" unselectable="on" onselectstart="return false;" >
        <div id="app" v-on:mousemove="mouseMove" v-on:mouseup="mouseUp" v-bind:style="{cursor: cursor}">
          <div id="menubar" class="panel">
            <div id="title">
            {{project.name}}
            </div>
            <div id="menu">
              <span v-on:click="loadProject">Öffnen</span>
              <span v-on:click="saveProject"></i>Speichern</span>
            </div>
            <div class="menu-right">
              <span class="loader" v-bind:style="{opacity: progress>0?1:0}"><span></span><span v-bind:style="{width: progress+'px'}"></span></span>
              <span id="fullPreview" v-on:click="fullPreview = !fullPreview"><i class="fa fa-magic" v-bind:style="{color: fullPreview?'#008dea':'inherit'}"></i></span>
              <span id="showSettings" v-show="selectedLayer!=null" v-on:click="selectedLayer=null"><i class="fa fa-wrench"></i><i class="fa fa-angle-right"></i></span>
            </div>
          </div>
          <div id="panels">
            <div id="toolbar" class="panel">
              <span v-for="tool in tools" v-on:click="selectedTool=tool; selectedLayer=(tool==tools.select?selectedLayer:null)" v-bind:class="[tool==selectedTool?'selected':'']">
                  <i class="fa fa-fw" v-bind:class="['fa-'+tool.icon]" ></i>
                  <i class="fa fa-plus" v-show="tool != tools.select"></i>
              </span>
              <div class="sidepanel-icons">
                <div v-on:click="sidepanel=0" v-bind:class="[sidepanel==0?'selected':'']">
                  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 54.953 54.953"  xml:space="preserve" width="24px" height="24px">
                    <g>
                    	<circle cx="45.021" cy="25.976" r="1"/><circle cx="9.021" cy="25.976" r="1"/><circle cx="12.021" cy="28.976" r="1"/><circle cx="18.021" cy="28.976" r="1"/><circle cx="15.021" cy="31.976" r="1"/><circle cx="21.021" cy="31.976" r="1"/>
                      <circle cx="24.021" cy="34.976" r="1"/><circle cx="30.021" cy="34.976" r="1"/><circle cx="33.021" cy="31.976" r="1"/><circle cx="27.021" cy="37.976" r="1"/></circle><circle cx="36.021" cy="28.976" r="1"/><circle cx="42.021" cy="28.976" r="1"/><circle cx="39.021" cy="31.976" r="1"/>
                      <path d="M45.559,32.796l9.394-5.367l-9.656-5.483l9.656-5.517L27.477,0.826L0,16.429l9.656,5.517L0,27.429l9.656,5.517L0,38.429   l27.477,15.698l27.477-15.698l-9.656-5.483l0.071-0.041C45.439,32.879,45.497,32.837,45.559,32.796z M27.477,3.125l23.436,13.309   l-7.637,4.364l0,0l-15.798,9.026L4.041,16.434L27.477,3.125z M11.129,23.409c0.162,0.333,0.497,0.567,0.892,0.567   c0.27,0,0.512-0.109,0.692-0.283l2.262,1.292c-0.53,0.025-0.954,0.455-0.954,0.991c0,0.552,0.448,1,1,1s1-0.448,1-1   c0-0.173-0.055-0.327-0.132-0.469l10.33,5.902c-0.116,0.163-0.198,0.352-0.198,0.567c0,0.552,0.448,1,1,1s1-0.448,1-1   c0-0.051-0.021-0.094-0.029-0.143l10.052-5.743c0.059,0.496,0.465,0.885,0.977,0.885c0.552,0,1-0.448,1-1   c0-0.325-0.165-0.601-0.406-0.783l2.202-1.258c0.068,0.015,0.132,0.041,0.204,0.041c0.444,0,0.807-0.294,0.938-0.694l0.32-0.183   l7.634,4.335l-1.983,1.133c-0.157-0.347-0.503-0.591-0.908-0.591c-0.552,0-1,0.448-1,1c0,0.216,0.083,0.405,0.199,0.568   l-3.945,2.254l0,0l-6.388,3.65c0.078-0.142,0.134-0.298,0.134-0.472c0-0.552-0.448-1-1-1s-1,0.448-1,1   c0,0.537,0.426,0.967,0.957,0.991l-2.263,1.293c-0.18-0.174-0.423-0.284-0.694-0.284c-0.552,0-1,0.448-1,1   c0,0.08,0.028,0.151,0.046,0.226l-4.59,2.622l-5.517-3.152c-0.13-0.401-0.494-0.696-0.939-0.696c-0.073,0-0.138,0.027-0.206,0.042   l-2.201-1.257c0.241-0.183,0.407-0.458,0.407-0.784c0-0.552-0.448-1-1-1c-0.512,0-0.919,0.391-0.977,0.887L6.991,29.12   c0.007-0.049,0.029-0.093,0.029-0.144c0-0.552-0.448-1-1-1c-0.239,0-0.449,0.095-0.621,0.235l-1.359-0.776L11.129,23.409z    M50.912,38.434l-23.436,13.39L4.041,38.434l7.633-4.335l15.803,9.028l15.802-9.028L50.912,38.434z"/>
                    </g>
                  </svg>
                </div>
                <div v-on:click="sidepanel=1" v-bind:class="[sidepanel==1?'selected':'']">
                  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 490 490" xml:space="preserve" width="24px" height="24px">
                    <g>
                      <path d="M446.533,142.01H43.467c-5.523,0-10-4.477-10-10V10c0-5.523,4.477-10,10-10h403.066c5.522,0,10,4.477,10,10v122.01     C456.533,137.533,452.056,142.01,446.533,142.01z M53.467,122.01h383.066V20H53.467V122.01z"/>
                  	  <path d="M446.533,490H43.467c-5.523,0-10-4.477-10-10V357.991c0-5.523,4.477-10,10-10h403.066c5.522,0,10,4.477,10,10V480     C456.533,485.523,452.056,490,446.533,490z M53.467,470h383.066V367.991H53.467V470z"/>
                  	  <path d="M142.925,307.566H43.467c-5.523,0-10-4.477-10-10V192.434c0-5.523,4.477-10,10-10h99.458c5.522,0,10,4.477,10,10v105.132     C152.925,303.089,148.447,307.566,142.925,307.566z M53.467,287.566h79.458v-85.132H53.467V287.566z"/>
                  	  <path d="M294.729,307.566h-99.457c-5.522,0-10-4.477-10-10V192.434c0-5.523,4.478-10,10-10h99.457c5.522,0,10,4.477,10,10     v105.132C304.729,303.089,300.251,307.566,294.729,307.566z M205.271,287.566h79.457v-85.132h-79.457V287.566z"/>
                  	  <path d="M446.533,307.566h-99.458c-5.522,0-10-4.477-10-10V192.434c0-5.523,4.478-10,10-10h99.458c5.522,0,10,4.477,10,10     v105.132C456.533,303.089,452.056,307.566,446.533,307.566z M357.075,287.566h79.458v-85.132h-79.458V287.566z"/>
                    </g>
                  </svg>
                </div>
                <div v-on:click="sidepanel=2" v-bind:class="[sidepanel==2?'selected':'']">
                  <i class="fa fa-users"></i>
                </div>
              </div>
            </div>
            <div id="layers" v-if="sidepanel==0" class="sidepanel panel">
              <div id="layer-heading" v-on:click="sublayers_open=false">
                <i v-if="sublayers_open" class="fa fa-fw fa-angle-left"></i>
                <span>{{sublayers_open?'Fräsbereich':'Arbeitsbereich'}}</span>
              </div>
              <transition-group name="move-layers" v-if="sublayers_open" tag="div">
                <div class="layer-item" v-bind:key="layer" v-bind:class="[selectedLayer==layer?'selected':'']" v-for="(layer, index) in layers" v-on:click="selectedLayer = layer">
                  <i v-bind:class="['fa', 'fa-fw', 'fa-'+getLayerIcon(layer)]"></i>
                  {{layer.title}}
                  <span>
                    <i class="fa fa-trash-o" v-on:click.stop="removeLayer(layer)"></i>
                    <i class="fa fa-bars layer-move-bars" v-on:mousedown="liftItem($event, layer)"></i>
                  </span>
                </div>
              </transition-group>
              <template v-else>
                <div class="layer-item" v-bind:class="[selectedLayer==machine?'selected':'']" v-on:click="selectedLayer = machine" v-on:dblclick="sublayers_open = true">
                  <i class="fa fa-th-large fa-fw"></i>
                  Fräsbereich
                  <span class="sublayer_link"><i class="fa fa-angle-right" v-on:click.stop="sublayers_open = true"></i></span>
                </div>
                <div class="layer-item" v-for="curve in curves" v-bind:class="[selectedLayer==curve?'selected':'']" v-on:click="selectedLayer=curve">
                  <i class="fa fa-pencil fa-fw"></i>
                  {{curve.title}}
                  <span>
                    <i class="fa fa-trash-o" v-on:click.stop="removeLayer(curve)"></i>
                  </span>
                </div>
                <div class="layer-item" v-for="image in images" v-bind:class="[selectedLayer==image?'selected':'']" v-on:click="selectedLayer = image">
                  <i class="fa fa-picture-o fa-fw"></i>
                  {{image.title}}
                  <span>
                    <i class="fa fa-trash-o" v-on:click.stop="removeLayer(image)"></i>
                  </span>
                </div>
                <div class="layer-item" v-for="text in texts" v-bind:class="[selectedLayer==text?'selected':'']" v-on:click="selectedLayer = text">
                  <i class="fa fa-font fa-fw"></i>
                  {{text.text}}
                  <span>
                    <i class="fa fa-trash-o" v-on:click.stop="removeLayer(text)"></i>
                  </span>
                </div>
              </template>
            </div>
            <div id="layers" v-if="sidepanel==1" class="sidepanel panel">
              <div id="layer-heading" v-on:click="sublayers_open = !sublayers_open">
                <span>Layouts</span>
                <i class="fa fa-fw" v-bind:class="[sublayers_open?'fa-angle-down':'fa-angle-up']"></i>
              </div>
              <div>
                <div class="layer-item" v-for="layout in layouts" v-on:click="buildLayout(layout.template); selectedLayout=layout" v-bind:class="[selectedLayout==layout?'selected':'']">
                  <i class="fa fa-columns"></i>{{layout.title}}
                  <span style="display: block">
                    <i v-if="layout.deleteable" class="fa fa-trash-o" v-on:click.stop="removeLayer(layout)"></i>
                  </span>
                </div>
              </div>
            </div>
            <div id="layers" v-if="sidepanel==2" class="sidepanel panel">
              <div id="layer-heading">
                <span>Live-Project</span>
              </div>
              <div class="dimen">
                <span>Name</span><input v-model="live.id" type="text" v-on:keyup.enter="joinProject"/>
              </div>
              <div class="dimen">
                <input type="button" value="Join" v-on:click="joinProject"/>
              </div>
            </div>
            <div id="workarea" v-on:mousedown="handleTool" v-on:mousewheel="handleZoom">
              <svg id="svg" height="100%" width="100%">
              </svg>
              <div v-if="selectedTool==tools.select" id="corner-tools">
                <div id="corner-zoom-bar">
                <div class="corner-zoom-point" type="zoom" v-bind:style="{top: Math.sqrt(project.zoom)*22.36+'%'}"></div></div>
                <div class="corner-move" type="action" v-on:click="tools.select.mode='move'">
                  <i class="fa fa-arrows"></i>
                </div>
                <div class="corner-move" type="action" v-on:click="centerProject">
                  <i class="fa fa-compress"></i>
                </div>
              </div>
            </div>
            <div v-show="selectedLayer!=null" id="settings" class="panel">
              <template v-if="layerType(selectedLayer)==0">
                <div class="settings-title">
                  <span>Titel <input type="text" v-model.lazy="selectedLayer.title" v-on:keyup.enter="$event.srcElement.blur()"/></span>
                  <i class="fa fa-trash-o" v-on:click="removeSelectedLayer()"></i>
                </div>
                <div class="settings-dimensions dimen-row-3">
                  <div class="dimen">
                    <span>B</span><input type="number" v-model.lazy.number="selectedLayer.dimens.w" v-on:keyup.enter="$event.srcElement.blur()"/>
                  </div>
                  <div class="dimen">
                    <span>X</span><input type="number" v-model.lazy.number="selectedLayer.dimens.x" v-on:keyup.enter="$event.srcElement.blur()"/>
                  </div>
                  <div class="dimen">
                    <span><i class="fa fa-repeat"></i></span><input type="number" v-model.lazy.number="selectedLayer.dimens.rot" v-on:keyup.enter="$event.srcElement.blur()"/>
                  </div>
                  <div class="dimen">
                    <span>H</span><input type="number" v-model.lazy.number="selectedLayer.dimens.h" v-on:keyup.enter="$event.srcElement.blur()"/>
                  </div>
                  <div class="dimen">
                    <span>Y</span><input type="number" v-model.lazy.number="selectedLayer.dimens.y" v-on:keyup.enter="$event.srcElement.blur()"/>
                  </div>
                </div>
                <div class="settings-panel">
                  <div class="settings-header">
                    <span>Rand</span>
                    <span><span>{{selectedLayer.links.border!=undefined?selectedLayer.links.border.str:''}}</span>
                      <i v-if="selectedLayer.links.border==undefined" class="fa fa-link" v-on:click="prepareLinking('border')"></i>
                      <i v-else class="fa fa-trash-o" v-on:click="unlink('border')"></i>
                    </span>
                    <ul v-show="linking.prop=='border'">
                      <li v-for="layer in layers.filter(el=>layerType(el)==0&el!=selectedLayer)" v-on:click="linkTo(layer)">
                        {{layer.title}}
                      </li>
                    </ul>
                  </div>
                  <div class="settings-dimensions dimen-row-4">
                    <div class="dimen">
                      <span><i class="fa fa-caret-right"></i></span><input type="number" v-model.lazy.number="selectedLayer.border.left" v-on:keyup.enter="$event.srcElement.blur()"/>
                    </div>
                    <div class="dimen">
                      <span><i class="fa fa-caret-left"></i></span><input type="number" v-model.lazy.number="selectedLayer.border.right" v-on:keyup.enter="$event.srcElement.blur()"/>
                    </div>
                    <div class="dimen">
                      <span><i class="fa fa-caret-down"></i></span><input type="number" v-model.lazy.number="selectedLayer.border.top" v-on:keyup.enter="$event.srcElement.blur()"/>
                    </div>
                    <div class="dimen">
                      <span><i class="fa fa-caret-up"></i></span><input type="number" v-model.lazy.number="selectedLayer.border.bottom" v-on:keyup.enter="$event.srcElement.blur()"/>
                    </div>
                  </div>
                </div>
                <div class="settings-panel">
                  <div class="settings-header">
                    <span>Rendering</span>
                    <span><span>{{selectedLayer.links.render!=undefined?selectedLayer.links.render.str:''}}</span>
                      <i v-if="selectedLayer.links.render==undefined" class="fa fa-link" v-on:click="prepareLinking('render')"></i>
                      <i v-else class="fa fa-trash-o" v-on:click="unlink('render')"></i>
                    </span>
                    <ul v-show="linking.prop=='render'">
                      <li v-for="layer in layers.filter(el=>layerType(el)==0&el!=selectedLayer)" v-on:click="linkTo(layer)">
                        {{layer.title}}
                      </li>
                    </ul>
                  </div>
                  <div class="settings.dimensions dimen-row">
                    <div class="dimen">
                      <span>Kurve</span>
                      <select v-model="selectedLayer.render.curve">
                        <option v-bind:value="curve.id" v-for="curve in curves">
                          {{curve.title}}
                        </option>
                      </select>
                      <i v-show="selectedLayer.render.curve" style="font-size: 12px" class="fa fa-sign-in" v-on:click="selectedLayer = curves.find(el=>el.id==selectedLayer.render.curve)"></i>
                    </div>
                    <div class="dimen">
                      <span>Bild</span>
                      <select v-model="selectedLayer.render.image">
                        <option v-bind:value="image.id" v-for="image in images">
                          {{image.title}}
                        </option>
                      </select>
                      <i v-show="selectedLayer.render.image" style="font-size: 12px" class="fa fa-sign-in" v-on:click="selectedLayer = images.find(el=>el.id==selectedLayer.render.image)"></i>
                    </div>
                  </div>
                  <div class="settings-dimensions dimen-row">
                    <div class="dimen">
                      <span>Linien</span>
                      <span>L</span><input type="number" v-model.lazy.number="selectedLayer.render.lines.l" v-on:keyup.enter="$event.srcElement.blur()"/>
                    </div>
                    <div class="dimen">
                      <span>R</span><input type="number" v-model.lazy.number="selectedLayer.render.lines.r" v-on:keyup.enter="$event.srcElement.blur()"/>
                    </div>
                    <div class="dimen">
                      <input type="button" value="Füllen" v-on:click="selectedLayer.render.lines.fill = true"/>
                    </div>
                    <div class="dimen">
                      <span>Punkte</span><input type="checkbox" v-model="selectedLayer.render.dotted" />
                    </div>
                    <div class="dimen">
                      <span><i class="fa fa-adjust"></i></span><input type="checkbox" v-model="selectedLayer.render.inverted"/>
                    </div>
                    <div class="dimen">
                      <span>Kantenglättung</span><input type="number" v-model.lazy.number="selectedLayer.render.refinedEdges" v-on:keyup.enter="$event.srcElement.blur()" />
                    </div>
                    <div class="dimen">
                      <span>Pixelglättung (%)</span><input type="number" v-model.lazy.number="selectedLayer.render.smooth" v-on:keyup.enter="$event.srcElement.blur()" />
                    </div>
                  </div>
                </div>
                <div v-if="gcodes.find(el => el.id == selectedLayer.id)" class="settings-panel">
                  <div class="settings-header">
                    <span>Zeit</span>
                  </div>
                  <div class="settings-dimensions dimen-row">
                    <div class="dimen">
                      <span>Benötigte Zeit</span><span>{{asTimeString(gcodes.find(el => el.id == selectedLayer.id).data.time)}}</span>
                    </div>
                  </div>
                </div>
              </template>
              <template v-else-if="layerType(selectedLayer)==1">
                <div class="settings-dimensions dimen-row">
                  <div class="dimen">
                    <span>B</span><input type="number" v-model.lazy.number="selectedLayer.dimens.w" v-on:keyup.enter="$event.srcElement.blur()"/>
                  </div>
                  <div class="dimen">
                    <span>H</span><input type="number" v-model.lazy.number="selectedLayer.dimens.h" v-on:keyup.enter="$event.srcElement.blur()"/>
                  </div>
                  <div class="dimen">
                    <span>Tiefe</span><input type="number" v-model.lazy.number="selectedLayer.bit.inDepth" v-on:keyup.enter="$event.srcElement.blur()"/>
                  </div>
                  <div class="dimen">
                    <span>Autom. Anpassen</span><input type="checkbox" v-model.lazy="project.autoAdjustMachine" v-on:click="adjustMachine()"/>
                  </div>
                </div>
                <div class="settings-panel">
                  <div class="settings-header">
                    <span>Bit</span>
                  </div>
                  <div class="settings-dimensions dimen-row">
                    <div class="dimen">
                      <span>Breite</span><input type="number" v-model.lazy.number="selectedLayer.bit.width" v-on:keyup.enter="$event.srcElement.blur()"/>
                    </div>
                    <div class="dimen">
                      <span>Höhe</span><input type="number" v-model.lazy.number="selectedLayer.bit.height" v-on:keyup.enter="$event.srcElement.blur()"/>
                    </div>
                    <div class="dimen">
                      <span>Spitze</span><input type="number" v-model.lazy.number="selectedLayer.bit.tip" v-on:keyup.enter="$event.srcElement.blur()"/>
                    </div>
                  </div>
                </div>
                <div class="settings-panel">
                  <div class="settings-header">
                    <span>Speed</span>
                  </div>
                  <div class="settings-dimensions dimen-row">
                    <div class="dimen">
                      <span>Seekrate</span><input type="number" v-model.lazy.number="selectedLayer.speed.seekrate" v-on:keyup.enter="$event.srcElement.blur()"/>
                    </div>
                    <div class="dimen">
                      <span>Feedrate</span><input type="number" v-model.lazy.number="selectedLayer.speed.feedrate" v-on:keyup.enter="$event.srcElement.blur()"/>
                    </div>
                    <div class="dimen">
                      <span>Feedrate (Dot.)</span><input type="number" v-model.lazy.number="selectedLayer.speed.feedrateDot" v-on:keyup.enter="$event.srcElement.blur()"/>
                    </div>
                    <div class="dimen">
                      <span>Höhe über Material</span><input type="number" v-model.lazy.number="selectedLayer.outHeight" v-on:keyup.enter="$event.srcElement.blur()"/>
                    </div>
                  </div>
                </div>
              </template>
              <template v-else-if="layerType(selectedLayer)==2">
                <div class="settings-title">
                  <span>Title <input type="text" v-model.lazy="selectedLayer.title" v-on:keyup.enter="$event.srcElement.blur()"/></span>
                  <i class="fa fa-trash-o" v-on:click="removeSelectedLayer()"></i>
                </div>
                <div class="settings-dimensions dimen-row-3">
                  <div class="dimen">
                    <span>B</span><input type="number" v-model.lazy.number="selectedLayer.dimens.w" v-on:keyup.enter="$event.srcElement.blur()"/>
                  </div>
                  <div class="dimen">
                    <span>X</span><input type="number" v-model.lazy.number="selectedLayer.dimens.x" v-on:keyup.enter="$event.srcElement.blur()"/>
                  </div>
                  <div class="dimen">
                    <span><i class="fa fa-repeat"></i></span><input type="number" v-model.lazy.number="selectedLayer.dimens.rot" v-on:keyup.enter="$event.srcElement.blur()"/>
                  </div>
                  <div class="dimen">
                    <span>H</span><input type="number" v-model.lazy.number="selectedLayer.dimens.h" v-on:keyup.enter="$event.srcElement.blur()"/>
                  </div>
                  <div class="dimen">
                    <span>Y</span><input type="number" v-model.lazy.number="selectedLayer.dimens.y" v-on:keyup.enter="$event.srcElement.blur()"/>
                  </div>
                </div>
                <div class="settings-dimensions dimen-row settings-panel">
                  <div class="settings-header">
                    <span>Datei</span>
                  </div>
                  <div class="dimen">
                    <input id="imageInput" type="button" value="Datei auswählen" v-on:click="loadImage" style="width: auto"/>
                  </div>
                  <div v-show="selectedLayer.data" class="dimen" style="height: auto">
                    <img id="preview" v-bind:src="selectedLayer.data" width="100%" />
                  </div>
                </div>
              </template>
              <template v-else-if="layerType(selectedLayer)==3">
                <div class="settings-title">
                  <span>Titel <input type="text" v-model.lazy="selectedLayer.title" v-on:keyup.enter="$event.srcElement.blur()"/></span>
                  <i class="fa fa-trash-o" v-on:click="removeSelectedLayer()"></i>
                </div>
                <div class="settings-dimensions dimen-row-3">
                  <div class="dimen">
                    <span>B</span><input type="number" v-model.lazy.number="selectedLayer.dimens.w" v-on:keyup.enter="$event.srcElement.blur()"/>
                  </div>
                  <div class="dimen">
                    <span>X</span><input type="number" v-model.lazy.number="selectedLayer.dimens.x" v-on:keyup.enter="$event.srcElement.blur()"/>
                  </div>
                  <div class="dimen">
                    <span><i class="fa fa-repeat"></i></span><input type="number" v-model.lazy.number="selectedLayer.dimens.rot" v-on:keyup.enter="$event.srcElement.blur()"/>
                  </div>
                  <div class="dimen">
                    <span>H</span><input type="number" v-model.lazy.number="selectedLayer.dimens.h" v-on:keyup.enter="$event.srcElement.blur()"/>
                  </div>
                  <div class="dimen">
                    <span>Y</span><input type="number" v-model.lazy.number="selectedLayer.dimens.y" v-on:keyup.enter="$event.srcElement.blur()"/>
                  </div>
                </div>
                <div class="settings-dimensions dimen-row">
                  <div class="dimen">
                    <span><i class="fa fa-adjust"></i></span><input type="checkbox" v-model="selectedLayer.mask"/>
                  </div>
                  <div class="dimen" v-show="selectedLayer.mask">
                    <span>Seperates Rendering</span><input type="checkbox" v-model="selectedLayer.ownRenderer" />
                  </div>
                </div>
                <div v-show="selectedLayer.mask & selectedLayer.ownRenderer" class="settings-panel">
                  <div class="settings-header">
                    <span>Rendering</span>
                    <!--<span><span>{{selectedLayer.links.render!=undefined?selectedLayer.links.render.str:''}}</span>
                      <i v-if="selectedLayer.links.render==undefined" class="fa fa-link" v-on:click="prepareLinking('render')"></i>
                      <i v-else class="fa fa-trash-o" v-on:click="unlink('render')"></i>
                    </span>
                    <ul v-show="linking.prop=='render'">
                      <li v-for="layer in layers.filter(el=>layerType(el)==0&el!=selectedLayer)" v-on:click="linkTo(layer)">
                        {{layer.title}}
                      </li>
                    </ul>-->
                  </div>
                  <div class="settings.dimenstions dimen-row">
                    <div class="dimen">
                      <span>Kurve</span>
                      <select v-model="selectedLayer.render.curve">
                        <option v-bind:value="curve.id" v-for="curve in curves">
                          {{curve.title}}
                        </option>
                      </select>
                      <i v-show="selectedLayer.render.curve" style="font-size: 12px" class="fa fa-sign-in" v-on:click="selectedLayer = curves.find(el=>el.id==selectedLayer.render.curve)"></i>
                    </div>
                    <div class="dimen">
                      <span>Bild</span>
                      <select v-model="selectedLayer.render.image">
                        <option v-bind:value="image.id" v-for="image in images">
                          {{image.title}}
                        </option>
                      </select>
                      <i v-show="selectedLayer.render.image" style="font-size: 12px" class="fa fa-sign-in" v-on:click="selectedLayer = images.find(el=>el.id==selectedLayer.render.image)"></i>
                    </div>
                  </div>
                  <div class="settings-dimensions dimen-row">
                    <div class="dimen">
                      <span>Linien</span><span>L</span><input type="number" v-model.lazy.number="selectedLayer.render.lines.l" v-on:keyup.enter="$event.srcElement.blur()"/>
                    </div>
                    <div class="dimen">
                      <span>R</span><input type="number" v-model.lazy.number="selectedLayer.render.lines.r" v-on:keyup.enter="$event.srcElement.blur()"/>
                    </div>
                    <div class="dimen">
                      <input type="button" value="Füllen" v-on:click="selectedLayer.render.lines.fill = true"/>
                    </div>
                    <div class="dimen">
                      <span>Kantenglättung</span><input type="number" v-model.lazy.number="selectedLayer.render.refinedEdges" v-on:keyup.enter="$event.srcElement.blur()" />
                    </div>
                    <div class="dimen">
                      <span>Pixelglättung (%)</span><input type="number" v-model.lazy.number="selectedLayer.render.smooth" v-on:keyup.enter="$event.srcElement.blur()" />
                    </div>
                  </div>
                </div>
                <div v-if="selectedLayer.gcode" class="settings-panel">
                  <div class="settings-header">
                    <span>Zeit</span>
                  </div>
                  <div class="settings-dimensions dimen-row">
                    <div class="dimen">
                      <span>Benötigte Zeit</span><span>{{asTimeString(selectedLayer.gcode.time)}}</span>
                    </div>
                  </div>
                </div>
              </template>
              <template v-else-if="layerType(selectedLayer)==4">
                <div class="settings-title">
                  <span>Titel <input type="text" v-model.lazy="selectedLayer.title" v-on:keyup.enter="$event.srcElement.blur()"/></span>
                  <i class="fa fa-trash-o" v-on:click="removeSelectedLayer()"></i>
                </div>
                <div class="settings-panel">
                  <div class="settings-header">
                    <span>Form</span>
                  </div>

                  <div class="settings-dimensions dimen-row">
                    <div class="dimen">
                      <select v-model="selectedLayer.type">
                        <option>Linie</option>
                        <option>Kurve</option>
                        <option>Kreis</option>
                        <option>Bogen</option>
                        <option>Welle</option>
                      </select>
                    </div>
                    <div class="dimen">
                      <span>Biegung</span><input type="number" v-model.lazy.number="selectedLayer.stretch" v-on:keyup.enter="$event.srcElement.blur()"/>
                    </div>
                    <div class="dimen" v-bind:class="[selectedLayer.type==0?'disabled':'']">
                      <span>Richtung</span><input type="number" v-model.lazy.number="selectedLayer.direction" v-on:change="mapRotation('direction', selectedLayer)" v-on:keyup.enter="$event.srcElement.blur()"/>
                    </div>
                  </div>
                </div>
                <div class="settings-panel">
                  <div class="settings-header">
                    <span>Anordnung</span>
                  </div>
                  <div class="settings-dimensions dimen-row">
                    <div class="dimen">
                      <span style="width: 40px; text-align: right">X</span><input type="number" v-model.lazy.number="selectedLayer.dimens.x" v-on:keyup.enter="$event.srcElement.blur()"/>
                    </div>
                    <div class="dimen">
                      <span style="width: 40px; text-align: right">Y</span><input type="number" v-model.lazy.number="selectedLayer.dimens.y" v-on:keyup.enter="$event.srcElement.blur()"/>
                    </div>
                  </div>
                  <div class="settings-dimensions dimen-row">
                    <div class="dimen">
                      <span style="width: 40px; text-align: right">Schritte</span><input type="number" v-model.lazy.number="selectedLayer.steps" v-on:keyup.enter="$event.srcElement.blur()"/>
                    </div>
                    <div class="dimen">
                      <span style="width: 40px; text-align: right">Abstand</span><input type="number" v-model.lazy.number="selectedLayer.gap" v-on:keyup.enter="$event.srcElement.blur()"/>
                    </div>
                  </div>
                </div>
              </template>
              <template v-else-if="layerType(selectedLayer)==5">
                <div class="settings-title">
                  <span>Text <input type="text" v-model.lazy="selectedLayer.text" v-on:keyup.enter="$event.srcElement.blur()"/></span>
                  <i class="fa fa-trash-o" v-on:click="removeSelectedLayer()"></i>
                </div>
                <div class="settings-dimensions dimen-row-3">
                  <div class="dimen">
                    <span>X</span><input type="number" v-model.lazy.number="selectedLayer.dimens.x" v-on:keyup.enter="$event.srcElement.blur()"/>
                  </div>
                  <div class="dimen">
                    <span>Y</span><input type="number" v-model.lazy.number="selectedLayer.dimens.y" v-on:keyup.enter="$event.srcElement.blur()"/>
                  </div>
                </div>
                <div class="settings-dimensions dimen-row">
                  <div class="dimen">
                    <span>Size</span><input type="number" v-model.lazy.number="selectedLayer.size" v-on:keyup.enter="$event.srcElement.blur()"/>
                  </div>
                </div>
              </template>
            </div>
          </div>
        </div>
        <div id="overlay">
          <span>Laden</span>
        </div>
        <script src="js/svg.js"></script>
        <script src="js/mouseevents.js"></script>
        <script src="js/data.js"></script>
        <script src="js/connection.js"></script>
        <script src="js/files.js"></script>
        <script src="js/app.js"></script>
    </body>
</html>
